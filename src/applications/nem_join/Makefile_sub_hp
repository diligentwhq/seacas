############################## RCS Info ######################################
#
# $RCSfile: Makefile_sub_hp,v $
#
# $Author: rwstotz $
#
# $Date: 1999/01/22 22:35:21 $
#
# $Revision: 1.10 $
#
##############################################################################

#
# Makefile for machine dependent directories
#

ifndef DCC
DCC=$(CC) -P -Wp,-Mtmp.d
endif

ifndef LNK
LNK=$(CC)
endif

include $(OBJFILES:.o=.d)

%.o:	%.c
	@echo "Compiling $<"
	$(CC) $(DEFS) -c $<
%.o:	%.f
	@echo "Compiling $<"
	@$(FC) $(FFLAGS) -c $<
%.d:	%.f
	@echo "(Re)Building dependency for $<"
	@$(SHELL) -ec 'echo $*.o $*.d: $< > $*.d'
%.d:	%.c
	@echo "Compiling and (re)building dependency for $<"
	$(DCC) -c  $(DEFS) $<
	@$(SHELL) -ec 'cat tmp.d | sed '\''s/.*$*.o/$*.o $@/g'\'' > $@'
	-$(RM) $*.i
	@/bin/rm tmp.d

$(TARGET):	$(OBJFILES) $(OBJFILES:.o=.d)
		@echo "Linking to create executable..."
		$(LNK) $(OBJFILES) -o $(TARGET) $(LIBS)


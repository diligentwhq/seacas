############################## RCS Info ######################################
#
# $RCSfile: Makefile_sub,v $
#
# $Author: rwstotz $
#
# $Date: 1999/01/22 22:35:20 $
#
# $Revision: 1.10 $
#
##############################################################################

#
# Makefile for machine dependent directories
#

ifndef DCC
DCC=$(CC)
endif
DEPS=-M

ifndef LNK
LNK=$(CC)
endif

include $(OBJFILES:.o=.d)

%.o:	%.c
	@echo "Compiling $<"
	$(CC) $(DEFS) -c $<
%.o:	%.f
	@echo "Compiling $<"
	@$(FC) $(FFLAGS) -c $<
%.d:	%.f
	@echo "(Re)Building dependency for $<"
	@$(SHELL) -ec 'echo $*.o $*.d: $< > $*.d'
%.d:	%.c
	@echo "(Re)Building dependency for $<"
	@$(SHELL) -ec '$(DCC) $(DEPS) $(DEFS) $< | sed '\''s/$*.o/& $@/g'\'' > $@'

$(TARGET):	$(OBJFILES) $(OBJFILES:.o=.d)
		@echo "Linking to create executable..."
		$(LNK) $(OBJFILES) -o $(TARGET) $(LIBS)

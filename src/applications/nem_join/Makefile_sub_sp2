############################## RCS Info ######################################
#
# $RCSfile: Makefile_sub_sp2,v $
#
# $Author: rwstotz $
#
# $Date: 1999/01/22 22:35:21 $
#
# $Revision: 1.10 $
#
##############################################################################

#
# Makefile for machine dependent directories
#

ifndef DCC
DCC=$(CC)
endif

ifndef LNK
LNK=$(CC)
endif

include $(OBJFILES:.o=.d)

%.o:	%.c
	@echo "Compiling $<"
	$(CC) $(DEFS) -c $<
%.o:	%.f
	@echo "Compiling $<"
	@$(FC) $(FFLAGS) -c $<
%.d:	%.f
	@echo "(Re)Building dependency for $<"
	@$(SHELL) -ec 'echo $*.o $*.d: $< > $*.d'

%.d:    ../%.c
	@echo "Rebuilding dependencies for $<..." 
	@sh -c '$(DCC) -E -M $(DEFS) $< > /dev/null' 
	@sh -c 'sed '\''s/$*.o/& $@/g'\'' $*.u > $@' 
	@$(RM) $*.u 


$(TARGET):	$(OBJFILES) $(OBJFILES:.o=.d)
		@echo "Linking to create executable..."
		$(LNK) $(OBJFILES) -o $(TARGET) $(LIBS)
